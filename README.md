# 微前端 乾坤 调研

## 背景

![](https://img.sz-p.cn/sz-pboard.jpg)
有一个[程序集成展示站点](https://sz-p.com/board)。如上图所示，整体架构为一个**主程序壳子**即上图所示的站点，一些**案例子程序**即上图中的各个展示案例。

## 目前解决方案

目前解决方案为`iframe`嵌套,主程序基于`react`,提供程序集列表展示功能，子程序独立部署，基于`nginx`路由。主要流程如下：

1. 主程序初始化时从子程序目录访问`config.js`获取所有的子程序配置项（即子程序的部署路径、截图路径、分类、排序等相关信息。）。
   
2. 主程序执行时从`config.js`获取相关信息，分页，提供路由。
   
3. 进入子应用路由时，基于`iframe`展示子应用。

### 目前以解决的问题

1. 主程序与子程序解耦
   > 目前主程序与子程序已解耦，子程序更新时只需要更新`config`，上传构建完毕的静态页面。 

2. 第三方嵌入式组件
   > 其实这部分并没有单独的解决方案、第三方嵌入式组件(stackblitz.io)也是提供的基于`iframe`的解决方案。之所以单独领出来是期望微前端架构在非`iframe`体系下仍支持第三方组件嵌入。

## 为什么尝试微前端解决方案

1. 相关依赖重复问题
   > 主应用依赖`react`、子应用普遍依赖`react`（特殊情况下版本略有不同），一些纯html页面、第三方嵌入式组件(stackblitz.io)、vue应用。 比如在一些极端情况下，每一个子应用都会打成一个`bundle`产生了大量的重复加载(例如内部相同版本的`react`模块)。这里期望在微前端框架这个层面上去解决改问题。

2. [`iframe`本身的问题](https://www.yuque.com/kuitos/gky7yw/gesexv)

3. [微前端本身所具备的一些工程优势](https://zhuanlan.zhihu.com/p/95085796)


## 尝试qiankun
